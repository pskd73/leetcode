from typing import List

class Solution:
    def numIslands(self, grid: List[List[str]]) -> int:
        cnt = 0
        iarr = [[0 for y in range(len(grid[x]))] for x in range(len(grid))]
        merges = []
        for row in range(len(grid)):
            for col in range(len(grid[row])):
                if grid[row][col] == '1':
                    top = iarr[row-1][col] if row > 0 else 0
                    left = iarr[row][col-1] if col > 0 else 0
                    
                    if top == 0 and left == 0:
                        cnt += 1
                        iarr[row][col] = cnt
                    elif left == 0:
                        iarr[row][col] = top
                    elif top == 0:
                        iarr[row][col] = left
                    elif top == left:
                        iarr[row][col] = top
                    elif left != 0 and top != 0 and left != top:
                        merges.append((left, top))
                        iarr[row][col] = top
                    else:
                        print('something wrong')

        clusters = []
        pointers = {}
        grouped = set()
        for m in merges:
            grouped.add(m[0])
            grouped.add(m[1])
            fci = pointers.get(m[0], -1)
            sci = pointers.get(m[1], -1)

            fc = clusters[fci] if fci != -1 else []
            sc = clusters[sci] if sci != -1 else []

            clusters.append(list(set(fc+sc+list(m))))

            for n in clusters[-1]:
                pointers[n] = len(clusters)-1

            if fci != -1:
                clusters[fci] = None
            if sci != -1:
                clusters[sci] = None

        il = 0
        for i in range(1, cnt+1):
            if i not in grouped:
                il += 1
        
        return len([x for x in clusters if x is not None]) + il

# 1
i2 = [
    ['0','1','0','0','1'],
    ['0','1','0','0','1'],
    ['0','1','1','1','1']
]

# 1
i3 = [
    ['1','1','1','1','0'],
    ['1','1','0','1','0'],
    ['1','1','0','0','0'],
    ['0','0','0','0','0']
]

# 1
i4 = [
    ["1","1","1","1","1","1","1"],
    ["0","0","0","0","0","0","1"],
    ["1","1","1","1","1","0","1"],
    ["1","0","0","0","1","0","1"],
    ["1","0","1","0","1","0","1"],
    ["1","0","1","1","1","0","1"],
    ["1","1","1","1","1","1","1"]
]

# 23
i5 = [
    ["1","0","1","1","0","0","1","0","1","1","1","1","0","1","0","1","1","1","1","0"],
    ["0","1","0","0","1","0","1","0","1","1","1","1","1","1","0","1","1","0","1","1"],
    ["1","0","0","1","0","1","0","1","0","1","1","0","1","1","1","0","0","1","1","0"],
    ["0","1","1","0","0","1","1","0","1","1","1","1","0","0","1","0","0","0","1","1"],
    ["1","1","0","1","0","0","1","0","0","0","1","0","1","0","1","1","1","0","1","1"],
    ["0","0","0","0","1","0","1","1","0","0","1","0","0","1","0","1","1","1","1","0"],
    ["1","0","1","1","1","1","0","1","1","0","1","1","0","1","1","1","0","0","1","0"],
    ["0","1","1","0","0","0","1","0","0","1","0","1","1","1","0","0","1","1","0","1"],
    ["0","0","0","0","1","1","0","1","0","0","1","1","0","1","0","0","1","0","1","0"],
    ["0","0","1","1","1","0","1","0","1","0","1","1","1","0","1","1","1","1","1","0"],
    ["1","0","1","0","1","1","1","0","1","1","1","0","1","0","1","0","1","0","1","1"],
    ["0","0","1","1","1","1","0","1","1","1","0","1","0","0","0","1","1","1","0","1"],
    ["1","1","1","0","0","0","0","0","1","1","0","1","1","1","0","1","1","1","1","0"],
    ["0","0","1","1","1","0","0","1","0","0","1","1","1","1","1","1","0","1","1","0"],
    ["0","0","0","1","1","0","0","0","0","1","1","0","1","0","0","1","1","1","1","1"],
    ["0","1","1","1","0","1","0","0","1","1","1","1","1","0","1","1","1","0","0","1"],
    ["0","0","0","0","1","1","1","1","0","0","0","0","1","0","0","0","0","1","1","0"],
    ["1","1","1","1","1","1","1","1","1","1","0","1","1","0","1","1","1","1","1","1"],
    ["0","1","0","0","1","0","0","1","1","1","1","1","1","0","1","0","1","1","1","1"],
    ["0","0","1","1","1","1","1","0","0","0","1","1","1","1","1","1","0","1","1","0"]
]

# 3
i6 = [
    ['1','1','0','0','0'],
    ['1','1','0','0','0'],
    ['0','0','1','0','0'],
    ['0','0','0','1','1']
]

# 1
i7 = [
    ["1","1","1","1","0","1","1","1","1","1","1","1","0","1","0","1","1","1","1","1"],
    ["1","1","1","1","1","1","1","1","1","1","1","0","1","1","1","1","1","1","1","1"],
    ["0","1","1","1","1","1","0","1","1","0","1","1","1","1","1","1","1","1","0","1"],
    ["1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","1"],
    ["1","1","1","1","0","1","1","1","1","1","1","1","1","0","1","1","1","1","0","1"],
    ["1","1","1","1","1","0","1","1","1","0","1","1","1","1","1","1","1","1","0","1"],
    ["1","1","1","1","0","1","1","1","1","1","1","1","1","1","1","0","1","1","1","1"],
    ["0","1","0","1","1","1","1","1","1","0","0","1","0","1","0","1","1","1","1","1"],
    ["1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1"],
    ["1","1","1","1","0","0","0","1","0","1","1","1","1","0","1","0","1","1","1","1"],
    ["1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1"],
    ["1","1","1","1","1","1","1","1","1","1","1","0","1","1","1","1","0","0","1","1"],
    ["0","1","1","1","1","1","1","1","1","1","1","0","1","1","1","1","1","1","1","1"],
    ["1","1","1","1","1","1","1","1","1","1","0","1","1","1","1","1","1","1","1","1"],
    ["1","1","1","1","1","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1"],
    ["1","1","1","1","1","1","1","1","1","1","1","1","0","1","1","1","1","0","1","1"],
    ["1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1"],
    ["1","0","1","1","1","0","1","1","1","1","0","1","1","1","1","1","1","1","1","1"],
    ["1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1"],
    ["1","1","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1"]
]

# 3
i8 = [["1","1","1","1","1","1","1","0","1","1","1","1","1","1","1","1","1","1","1","1"],["1","1","1","1","1","1","0","1","1","1","0","1","0","1","0","1","1","1","1","1"],["1","1","1","1","1","1","1","1","1","1","1","0","0","0","1","1","1","1","0","0"],["1","0","1","0","1","1","1","1","0","1","0","1","0","1","1","0","1","1","1","1"],["1","0","1","1","1","1","1","1","0","1","1","0","0","1","1","1","0","1","1","1"],["0","1","1","1","1","1","0","1","1","0","1","0","0","1","1","1","0","1","1","1"],["1","1","1","1","1","1","1","1","0","1","1","1","0","1","0","1","1","1","1","1"],["1","1","1","1","1","0","1","1","1","1","1","0","1","0","1","0","1","0","1","1"],["0","1","1","1","1","1","1","1","0","1","0","1","1","0","1","1","1","0","0","1"],["0","1","0","0","0","1","1","1","1","1","1","0","1","1","1","0","1","0","1","0"],["0","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1"],["1","0","1","1","0","1","1","1","1","1","1","1","1","1","1","1","0","1","0","1"],["1","1","1","1","1","1","0","1","0","1","1","0","1","0","1","1","1","1","1","1"],["1","1","1","1","1","1","1","1","1","1","1","0","1","1","1","1","1","1","1","0"],["1","1","0","1","0","1","1","1","0","1","1","1","1","1","1","1","1","1","1","1"],["1","1","1","1","1","1","0","1","1","1","0","1","1","1","0","1","1","0","0","1"],["1","0","1","1","1","1","1","1","1","1","1","1","0","0","1","1","1","1","1","1"],["1","0","0","1","1","1","0","0","1","1","0","1","1","1","0","0","1","1","1","1"],["1","1","1","0","1","1","0","0","0","1","0","0","1","1","1","1","0","0","1","1"],["1","1","1","1","1","1","1","1","0","1","1","1","1","1","1","1","0","1","0","1"]]

s = Solution()
print(s.numIslands(i8))